{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["'use strict'\n\nimport axios from 'axios';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst form = document.querySelector(\".search-img-form\");\nconst gallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\nconst loadMoreBtn = document.querySelector(\".load-more-btn\")\n\nconst lightbox = new SimpleLightbox('.gallery a', { captionsData: 'alt', captionDelay: 250 });\n\nform.addEventListener(\"submit\", submitFunction);\nloadMoreBtn.addEventListener('click', fetchMoreImages)\n    \nfunction searchParams(q, page) {\n    const api = axios.create({\n        baseURL: \"https://pixabay.com/api/\",\n        params: {\n            key: \"41836139-8e3290e3b09a716b148135a6e\",\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            q,\n            page,\n            per_page: 40,\n        }\n    })\n\n    return api.get()\n}\n\nasync function createRequest(query, page) {\n    try {\n        const response = await searchParams(query, page);\n\n        if (response.data.totalHits === 0) {\n            loadMoreBtn.classList.add(\"is-hidden\");\n\n            return  iziToast.error({\n                message: \"Sorry, there are no images matching your search query. Please try again!\",\n                position: \"topRight\"\n            })\n\n        }\n\n        return response.data;\n    \n    } catch (error) {\n        console.log(error);\n    }\n\n}\n\nlet fetchImages = null;\nlet page = 1;\n\nfunction submitFunction(event) {\n    event.preventDefault();\n    gallery.innerHTML = '';\n    const query = event.currentTarget.elements.search.value;\n    loadMoreBtn.classList.add(\"is-hidden\")\n    page = 1\n    \n    if (query === \"\" || query === undefined) {\n        iziToast.error({\n            message: \"Please, fill in the search field\",\n            position: \"topRight\"\n        })\n        return\n    }\n\n    fetchImages = async () => {\n        try {\n            loader.classList.remove(\"is-hidden\");\n            const response = await createRequest(query, page);\n            page += 1;\n            loader.classList.add(\"is-hidden\");\n\n            galleryMarkup(response.hits);\n            lightbox.refresh();\n\n\n            if (page > 1 && response.totalHits > 40) {\n                loadMoreBtn.classList.remove(\"is-hidden\");\n            }\n\n            return response\n\n        } catch (error) {\n            console.log(error);\n        }\n\n    }\n\n    fetchImages()\n\n    form.reset()\n\n    return page\n}\n\nasync function fetchMoreImages() {\n    loadMoreBtn.classList.add(\"is-hidden\");\n    const response = await fetchImages();\n\n    const galleryItemRect = document.querySelector(\".gallery-item\").getBoundingClientRect();\n        window.scrollBy({\n            top: galleryItemRect.height * 2.0,\n            left: 0,\n            behavior: 'smooth',\n        });\n    \n    if (page > (Math.ceil(response.totalHits / 40))) {\n        iziToast.info({\n            message: \"We're sorry, but you've reached the end of search results.\",\n            position: \"topRight\"\n        })\n            \n        loadMoreBtn.classList.add(\"is-hidden\");\n    }  \n}\n\n//Create gallery markup\nfunction galleryMarkup(images) {\n    const markup = images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n        `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n            <div class=\"image-info\">\n              <p class=\"likes\">Likes ${likes}</p>\n              <p class=\"views\">Views ${views}</p>\n              <p class=\"comments\">Comments ${comments}</p>\n              <p class=\"downloas\">Downloas ${downloads}</p>\n            </div>\n          </a>\n        </li>`\n    ).join(\"\");\n\n    gallery.insertAdjacentHTML(\"beforeend\", markup)\n}; \n"],"names":["form","gallery","loader","loadMoreBtn","lightbox","SimpleLightbox","submitFunction","fetchMoreImages","searchParams","q","page","axios","createRequest","query","response","iziToast","error","fetchImages","event","galleryMarkup","galleryItemRect","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"owBAQA,MAAMA,EAAO,SAAS,cAAc,kBAAkB,EAChDC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,gBAAgB,EAErDC,EAAW,IAAIC,EAAe,aAAc,CAAE,aAAc,MAAO,aAAc,GAAG,CAAE,EAE5FL,EAAK,iBAAiB,SAAUM,CAAc,EAC9CH,EAAY,iBAAiB,QAASI,CAAe,EAErD,SAASC,EAAaC,EAAGC,EAAM,CAc3B,OAbYC,EAAM,OAAO,CACrB,QAAS,2BACT,OAAQ,CACJ,IAAK,qCACL,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,EAAAF,EACA,KAAAC,EACA,SAAU,EACb,CACT,CAAK,EAEU,IAAK,CACpB,CAEA,eAAeE,EAAcC,EAAOH,EAAM,CACtC,GAAI,CACA,MAAMI,EAAW,MAAMN,EAAaK,EAAOH,CAAI,EAE/C,OAAII,EAAS,KAAK,YAAc,GAC5BX,EAAY,UAAU,IAAI,WAAW,EAE7BY,EAAS,MAAM,CACnB,QAAS,2EACT,SAAU,UAC1B,CAAa,GAIED,EAAS,IAEnB,OAAQE,EAAO,CACZ,QAAQ,IAAIA,CAAK,CACpB,CAEL,CAEA,IAAIC,EAAc,KACdP,EAAO,EAEX,SAASJ,EAAeY,EAAO,CAC3BA,EAAM,eAAc,EACpBjB,EAAQ,UAAY,GACpB,MAAMY,EAAQK,EAAM,cAAc,SAAS,OAAO,MAIlD,GAHAf,EAAY,UAAU,IAAI,WAAW,EACrCO,EAAO,EAEHG,IAAU,IAAMA,IAAU,OAAW,CACrCE,EAAS,MAAM,CACX,QAAS,mCACT,SAAU,UACtB,CAAS,EACD,MACH,CAED,OAAAE,EAAc,SAAY,CACtB,GAAI,CACAf,EAAO,UAAU,OAAO,WAAW,EACnC,MAAMY,EAAW,MAAMF,EAAcC,EAAOH,CAAI,EAChD,OAAAA,GAAQ,EACRR,EAAO,UAAU,IAAI,WAAW,EAEhCiB,EAAcL,EAAS,IAAI,EAC3BV,EAAS,QAAO,EAGZM,EAAO,GAAKI,EAAS,UAAY,IACjCX,EAAY,UAAU,OAAO,WAAW,EAGrCW,CAEV,OAAQE,EAAO,CACZ,QAAQ,IAAIA,CAAK,CACpB,CAEJ,EAEDC,EAAa,EAEbjB,EAAK,MAAO,EAELU,CACX,CAEA,eAAeH,GAAkB,CAC7BJ,EAAY,UAAU,IAAI,WAAW,EACrC,MAAMW,EAAW,MAAMG,IAEjBG,EAAkB,SAAS,cAAc,eAAe,EAAE,sBAAqB,EACjF,OAAO,SAAS,CACZ,IAAKA,EAAgB,OAAS,EAC9B,KAAM,EACN,SAAU,QACtB,CAAS,EAEDV,EAAQ,KAAK,KAAKI,EAAS,UAAY,EAAE,IACzCC,EAAS,KAAK,CACV,QAAS,6DACT,SAAU,UACtB,CAAS,EAEDZ,EAAY,UAAU,IAAI,WAAW,EAE7C,CAGA,SAASgB,EAAcE,EAAQ,CAC3B,MAAMC,EAASD,EAAO,IAAI,CAAC,CAAE,aAAAE,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAC/F;AAAA,0CACkCL,CAAa;AAAA,8CACTD,CAAY,UAAUE,CAAI;AAAA;AAAA,uCAEjCC,CAAK;AAAA,uCACLC,CAAK;AAAA,6CACCC,CAAQ;AAAA,6CACRC,CAAS;AAAA;AAAA;AAAA,cAItD,EAAM,KAAK,EAAE,EAET5B,EAAQ,mBAAmB,YAAaqB,CAAM,CAClD"}
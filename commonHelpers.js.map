{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["'use strict'\n\nimport axios from 'axios';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst form = document.querySelector(\".search-img-form\");\nconst gallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\nconst loadMoreBtn = document.querySelector(\".load-more-btn\")\n\nconst lightbox = new SimpleLightbox('.gallery a', { captionsData: 'alt', captionDelay: 250 });\n\nform.addEventListener(\"submit\", submitFunction)\n    \nfunction searchParams(q, page) {\n    const api = axios.create({\n        baseURL: \"https://pixabay.com/api/\",\n        params: {\n            key: \"41836139-8e3290e3b09a716b148135a6e\",\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            q,\n            page,\n            per_page: 40,\n        }\n    })\n\n    return api.get()\n}\n\nasync function createRequest(query, page) {\n    try {\n        const response = await searchParams(query, page);\n\n        if (response.data.totalHits === 0) {\n            iziToast.error({\n                message: \"Sorry, there are no images matching your search query. Please try again!\",\n                position: \"topRight\"\n            })\n\n            loadMoreBtn.classList.add(\"is-hidden\");\n        }\n\n        return response.data;\n    \n    } catch (error) {\n        console.log(error);\n    }\n\n}\n\n// Function for search form listener\nlet fetchImages = false;\n\nfunction submitFunction(event) {\n    event.preventDefault();\n    gallery.innerHTML = '';\n    const query = event.currentTarget.elements.search.value;\n    loadMoreBtn.classList.add(\"is-hidden\")\n    let page = 1;\n    \n    if (fetchImages) {\n        loadMoreBtn.removeEventListener(\"click\", fetchImages);\n        fetchImages = false;\n    }\n    \n    if (query === \"\" || query === undefined) {\n        iziToast.error({\n            message: \"Please, fill in the search field\",\n            position: \"topRight\"\n        })\n        return\n    }\n\n    fetchImages = async() => {\n        try {\n            loader.classList.remove(\"is-hidden\");\n            const response = await createRequest(query, page);\n            page += 1;\n            loader.classList.add(\"is-hidden\");\n\n            if (response.totalHits > 0) {\n                galleryMarkup(response.hits);\n                lightbox.refresh();\n            }\n\n            if (page > 1 && response.totalHits > 40) {\n                loadMoreBtn.classList.remove(\"is-hidden\");\n            }\n\n            return response\n\n        } catch (error) {\n            console.log(error);\n        }\n\n    }\n\n    fetchImages()\n\n    form.reset()\n\n    loadMoreBtn.addEventListener(\"click\", async () => { \n        loadMoreBtn.classList.add(\"is-hidden\");\n\n        const response = await fetchImages();\n\n        const galleryItemRect = document.querySelector(\".gallery-item\").getBoundingClientRect();\n        window.scrollBy({\n            top: galleryItemRect.height * 2.0,\n            left: 0,\n            behavior: 'smooth',\n        });\n\n        if (page > (Math.ceil(response.totalHits / 40))) {\n            setTimeout(() => {\n                iziToast.info({\n                    message: \"We're sorry, but you've reached the end of search results.\",\n                    position: \"topRight\"\n                })\n            }, 1000);\n            loadMoreBtn.classList.add(\"is-hidden\");\n        }\n       \n    })\n}\n\n//Create gallery markup\nfunction galleryMarkup(images) {\n    const markup = images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n        `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n            <div class=\"image-info\">\n              <p class=\"likes\">Likes ${likes}</p>\n              <p class=\"views\">Views ${views}</p>\n              <p class=\"comments\">Comments ${comments}</p>\n              <p class=\"downloas\">Downloas ${downloads}</p>\n            </div>\n          </a>\n        </li>`\n    ).join(\"\");\n\n    gallery.insertAdjacentHTML(\"beforeend\", markup)\n}; \n\n"],"names":["form","gallery","loader","loadMoreBtn","lightbox","SimpleLightbox","submitFunction","searchParams","q","page","axios","createRequest","query","response","iziToast","error","fetchImages","event","galleryMarkup","galleryItemRect","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"owBAQA,MAAMA,EAAO,SAAS,cAAc,kBAAkB,EAChDC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,gBAAgB,EAErDC,EAAW,IAAIC,EAAe,aAAc,CAAE,aAAc,MAAO,aAAc,GAAG,CAAE,EAE5FL,EAAK,iBAAiB,SAAUM,CAAc,EAE9C,SAASC,EAAaC,EAAGC,EAAM,CAc3B,OAbYC,EAAM,OAAO,CACrB,QAAS,2BACT,OAAQ,CACJ,IAAK,qCACL,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,EAAAF,EACA,KAAAC,EACA,SAAU,EACb,CACT,CAAK,EAEU,IAAK,CACpB,CAEA,eAAeE,EAAcC,EAAOH,EAAM,CACtC,GAAI,CACA,MAAMI,EAAW,MAAMN,EAAaK,EAAOH,CAAI,EAE/C,OAAII,EAAS,KAAK,YAAc,IAC5BC,EAAS,MAAM,CACX,QAAS,2EACT,SAAU,UAC1B,CAAa,EAEDX,EAAY,UAAU,IAAI,WAAW,GAGlCU,EAAS,IAEnB,OAAQE,EAAO,CACZ,QAAQ,IAAIA,CAAK,CACpB,CAEL,CAGA,IAAIC,EAAc,GAElB,SAASV,EAAeW,EAAO,CAC3BA,EAAM,eAAc,EACpBhB,EAAQ,UAAY,GACpB,MAAMW,EAAQK,EAAM,cAAc,SAAS,OAAO,MAClDd,EAAY,UAAU,IAAI,WAAW,EACrC,IAAIM,EAAO,EAOX,GALIO,IACAb,EAAY,oBAAoB,QAASa,CAAW,EACpDA,EAAc,IAGdJ,IAAU,IAAMA,IAAU,OAAW,CACrCE,EAAS,MAAM,CACX,QAAS,mCACT,SAAU,UACtB,CAAS,EACD,MACH,CAEDE,EAAc,SAAW,CACrB,GAAI,CACAd,EAAO,UAAU,OAAO,WAAW,EACnC,MAAMW,EAAW,MAAMF,EAAcC,EAAOH,CAAI,EAChD,OAAAA,GAAQ,EACRP,EAAO,UAAU,IAAI,WAAW,EAE5BW,EAAS,UAAY,IACrBK,EAAcL,EAAS,IAAI,EAC3BT,EAAS,QAAO,GAGhBK,EAAO,GAAKI,EAAS,UAAY,IACjCV,EAAY,UAAU,OAAO,WAAW,EAGrCU,CAEV,OAAQE,EAAO,CACZ,QAAQ,IAAIA,CAAK,CACpB,CAEJ,EAEDC,EAAa,EAEbhB,EAAK,MAAO,EAEZG,EAAY,iBAAiB,QAAS,SAAY,CAC9CA,EAAY,UAAU,IAAI,WAAW,EAErC,MAAMU,EAAW,MAAMG,IAEjBG,EAAkB,SAAS,cAAc,eAAe,EAAE,sBAAqB,EACrF,OAAO,SAAS,CACZ,IAAKA,EAAgB,OAAS,EAC9B,KAAM,EACN,SAAU,QACtB,CAAS,EAEGV,EAAQ,KAAK,KAAKI,EAAS,UAAY,EAAE,IACzC,WAAW,IAAM,CACbC,EAAS,KAAK,CACV,QAAS,6DACT,SAAU,UAC9B,CAAiB,CACJ,EAAE,GAAI,EACPX,EAAY,UAAU,IAAI,WAAW,EAGjD,CAAK,CACL,CAGA,SAASe,EAAcE,EAAQ,CAC3B,MAAMC,EAASD,EAAO,IAAI,CAAC,CAAE,aAAAE,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAC/F;AAAA,0CACkCL,CAAa;AAAA,8CACTD,CAAY,UAAUE,CAAI;AAAA;AAAA,uCAEjCC,CAAK;AAAA,uCACLC,CAAK;AAAA,6CACCC,CAAQ;AAAA,6CACRC,CAAS;AAAA;AAAA;AAAA,cAItD,EAAM,KAAK,EAAE,EAET3B,EAAQ,mBAAmB,YAAaoB,CAAM,CAClD"}